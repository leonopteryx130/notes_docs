# 判断对象是否存活的方法

浏览器的垃圾回收机制（其实不止是浏览器，大多数编译器都有这个机制）需要判断堆内存中对象是否存活，方法主要有如下几个：

1. **引用计数法：**
给对象中添加一个 引用计数器，每当有一个地方引用它时，计数器值+1，当引用失效时，计数器值-1。任何时刻计数器值为0的对象就是不可能再被使用的。但是这个方法有个问题不能解决：就是当两个对象相互引用时，他们的计数器值永远不会变成0，导致两个对象无法被回收。
2. **可达性分析算法：**
将一系列称为"GC Roots"的对象作为起始点，从这些节点开始往下搜索，搜索走过的路径称为路径链（Reference Chain），当一个没有一条可以到GC Roots的路径链，那么说明GC Roots到此对象不可达（“不可达”是图论里边的术语），说明此对象不可用。
<div align="center">
    <img src=./判断对象是否存活1.png width=70% />
</div>
比如图中的Object5，Object6，Object7 是判定可以回收的对象。

3. **标记-复制算法：**
标记-复制（Mark-Copy）算法将内存分成大小相同的两块，当某一块的内存使用完了之后就将使用中的对象挨个复制到另一块内存中，最后将当前内存恢复未使用的状态。图示如下：
<div align="center">
    <img src=./判断对象是否存活2.jpg width=80% />
</div>

标记-清除法需要在清除阶段对大量垃圾对象进行扫描，标记-复制则只需要从GC Root对象出发，将“可到达”的对象复制到另一块内存后直接清理当前这块的内存，因此提升了垃圾回收的效率解决了内存碎片化的问题，防止分配较大连续空间时的提前GC问题，但是内存利用率较低，相当于可利用内存只有实际内存的一半。
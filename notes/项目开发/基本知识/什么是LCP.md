# 什么是LCP

在现代网站和单页应用程序的发展下，传统的FP和FCP已经不能满足作为评估网页加载性能的指标了，比如某个网站渲染出了一个背景图或者背景色，对于用户来说和白屏其实没有太大区别。

**最大内容绘制时间 Largest Contentful Paint (LCP)**：页面首次开始加载之后，页面视图中的最大的图片和文字块的呈现时间。

### **LCP指标所关心的内容**：

- img
- 在SVG中的image
- video ( 需要带封面 ）
- 通过url()函数加载背景图像的DIV，或者使用了CSS渐变色的DIV
- 包含文本节点或其他内联级文本元素的块

这是谷歌公司为了尽可能让指标概念简单化，所做的规定。

### **如何判断是最大的呢?**

报告为最大内容绘制元素的大小通常是用户在视口中可见的大小。如果元素扩展到视口之外，或者任何元素被裁剪或有不可见的溢出，这些部分不计入元素的大小。对于从固有尺寸调整大小的图像元素，报告的尺寸可以是可见尺寸，也可以是固有尺寸，以较小的为准。例如，缩小到比其固有尺寸小得多的图像将只报告其显示的尺寸，而拉伸或扩大到较大尺寸的图像将只报告其固有尺寸。对于文本元素，只考虑其文本节点的大小(包含所有文本节点的最小矩形)。对于所有的元素，通过CSS应用的任何边距、填充或边框都不会被考虑。

为了降低计算和分配新的性能条目的性能开销，改变元素的大小或位置不会产生新的LCP候选项。只考虑元素在视口中的初始大小和位置。这意味着最初在屏幕外渲染然后在屏幕上转换的图像可能不会被报告。这也意味着元素最初呈现在视图中，然后被下推到视图之外，仍然会报告他们的初始视图中的大小。

### **举几个例子**：

<div align="center">
    <img src=./什么是LCP1.png width=90% />
</div>

在上面的两个例子中，最大的元素随着内容加载而变化。在第一个例子中，不断有新的内容被添加到DOM中，这就改变了哪个元素是最大的。在第二个例子中，布局变化和以前最大的内容从视口中被删除。通常情况下，延迟加载的内容比页面上已经存在的内容更大。

<div align="center">
    <img src=./什么是LCP2.png width=90% />
</div>

在第一个例子中，Instagram的logo加载相对较早，即使其他内容逐步显示，它仍然是最大的元素。在谷歌搜索结果页面的例子中，最大的元素是在任何图像或logo加载完成之前显示的一段文本。因为所有单独的图像都比这个段落小，所以在整个加载过程中，它仍然是最大的元素。在Instagram时间轴的第一帧中，你可能会注意到相机的logo周围没有一个绿色的方框。那是因为它是svg元素。svg元素目前不被认为是LCP的候选元素。第一个LCP候选是第二帧中的文本。